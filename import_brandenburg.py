from app.scripts.brandenburg_xml_parser import parse_xml; from app.services.structured_data_service import structured_data_service; import requests; url = "https://www.stadt-brandenburg.de/_/a/chatbot/daten.xml"; tenant_id = "9d8d5dcf-f6b3-4d06-8016-0f24869f8872"; print(f"Importiere Daten für Tenant {tenant_id}..."); response = requests.get(url); if response.status_code == 200: print("XML erfolgreich heruntergeladen"); xml_content = response.content; result = parse_xml(xml_content); print(f"Geparste Daten: {len(result.get(schools, []))} Schulen, {len(result.get(offices, []))} Ämter, {len(result.get(events, []))} Veranstaltungen"); for school in result.get("schools", []): structured_data_service.create_schema_for_type(tenant_id, "school"); success = structured_data_service.store_structured_data(tenant_id, "school", school["data"]); if success: print(f"Schule {school[data].get(name)} importiert"); for office in result.get("offices", []): structured_data_service.create_schema_for_type(tenant_id, "office"); success = structured_data_service.store_structured_data(tenant_id, "office", office["data"]); if success: print(f"Amt {office[data].get(name)} importiert"); for event in result.get("events", []): structured_data_service.create_schema_for_type(tenant_id, "event"); success = structured_data_service.store_structured_data(tenant_id, "event", event["data"]); if success: print(f"Veranstaltung {event[data].get(title)} importiert"); print("Import abgeschlossen"); else: print(f"Fehler beim Herunterladen der XML: {response.status_code}")
